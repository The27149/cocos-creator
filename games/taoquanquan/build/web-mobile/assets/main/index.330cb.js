window.__require=function t(e,o,n){function i(c,s){if(!o[c]){if(!e[c]){var a=c.split("/");if(a=a[a.length-1],!e[a]){var l="function"==typeof __require&&__require;if(!s&&l)return l(a,!0);if(r)return r(a,!0);throw new Error("Cannot find module '"+c+"'")}c=a}var u=o[c]={exports:{}};e[c][0].call(u.exports,function(t){return i(e[c][1][t]||t)},u,u.exports,t,e,o,n)}return o[c].exports}for(var r="function"==typeof __require&&__require,c=0;c<n.length;c++)i(n[c]);return i}({Game:[function(t,e,o){"use strict";cc._RF.push(e,"4c6878qeYNCaaht9RMHdhOL","Game");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c},c=this&&this.__spreadArrays||function(){for(var t=0,e=0,o=arguments.length;e<o;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<o;e++)for(var r=arguments[e],c=0,s=r.length;c<s;c++,i++)n[i]=r[c];return n};Object.defineProperty(o,"__esModule",{value:!0});var s=t("./Hall"),a=t("./Ring"),l=t("./SoundMgr"),u=t("./common/Global"),p=t("./common/Module"),h=t("./common/Move"),f=t("./common/NodeFactory"),d=t("./common/Utils"),y=cc._decorator,g=y.ccclass,v=y.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.boardNode=null,e.ringPre=null,e.lineEffectPre=null,e.nextContainer=null,e.scoreLabel=null,e.backBtn=null,e.resultNode=null,e.effectLayer=null,e.ringList=[],e.ringFactory=new f.NodeFactory,e.lineEffectFactory=new f.NodeFactory,e.ringColors=[u.COLOR_TYPE.RED,u.COLOR_TYPE.ORANGE,u.COLOR_TYPE.YELLOW,u.COLOR_TYPE.BLUE,u.COLOR_TYPE.PURPLE],e.dragRing=null,e.eliminateList=[],e._score=0,e.showTw=null,e.hideTw=null,e}return i(e,t),Object.defineProperty(e.prototype,"score",{get:function(){return this._score},set:function(t){this._score=t,this.scoreLabel.string=t.toString()},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.ringFactory.init(this.ringPre),this.lineEffectFactory.init(this.lineEffectPre),this.init(),this.node.active=!1,this.resultNode.active=!1},e.prototype.init=function(){var t=this;this.boardNode.children.forEach(function(e){var o=t.ringFactory.get();o.parent=e;var n=o.getComponent(a.default);t.ringList.push(n),n.initAsBlend()}),this.backBtn.node.on("click",this.onClickBack,this);var e=u.GConst.changeSceneTime;this.showTw=cc.tween(this.node).set({opacity:0,active:!0}).to(e,{opacity:255}),this.hideTw=cc.tween(this.node).set({opacity:255}).to(e,{opacity:0}).set({active:!1})},e.prototype.onClickBack=function(){p.default.get(l.default).playEffect(u.SoundPath.button),this.hide(),p.default.get(s.default).show()},e.prototype.show=function(){var t=this;this.showTw.start(),this.scheduleOnce(function(){t.newGame()},0)},e.prototype.hide=function(){this.hideTw.start()},e.prototype.newGame=function(){this.score=0,this.eliminateList.length=0,this.ringList.forEach(function(t){return t.reset()}),this.clearDragRing(),this.createDragRing()},e.prototype.createDragRing=function(){var t=this.ringFactory.get();t.parent=this.nextContainer;var e=t.getComponent(a.default);e.initAsDrag(),this.dragRing=e;var o=this.nextContainer.convertToWorldSpaceAR(cc.v2()).y;t.y=-o,cc.tween(t).set({y:-o}).to(.3,{y:0}).start()},e.prototype.clearDragRing=function(){for(;this.nextContainer.childrenCount>0;){var t=this.nextContainer.children[0];cc.Tween.stopAllByTarget(t),this.ringFactory.put(t)}this.dragRing=null},e.prototype.checkEliminate=function(){var t=this;this.eliminateList.length=0,u.lineConfig.forEach(function(e){var o=e.type,n=e.id;if(1===o)t.ringColors.forEach(function(o){if(e.ringsIdx.every(function(e){return t.ringList[e-1].isIncludeColor(o)})){var i=t.eliminateList.find(function(t){return t.lineId===n});i?i.colors.push(o):(i={lineId:n,rings:c(e.ringsIdx),colors:[o]},t.eliminateList.push(i))}});else if(2===o){var i=e.ringsIdx[0],r=t.ringList[i-1];if(r.isSameColor()){var s={lineId:n,rings:[i],colors:[r.getCircleColor(0)]};t.eliminateList.push(s)}}}),d.default.log("\u5f85\u6d88\u9664\u7684\u7ebf\u5217\u8868\uff1a",this.eliminateList),this.eliminate()},e.prototype.eliminate=function(){var t=this;this.eliminateList.forEach(function(e){e.rings.forEach(function(o){t.ringList[o-1].eliminateCircle(e.colors)});var o=t.ringList[e.rings[0]-1].node,n=t.ringList[e.rings[e.rings.length-1]-1].node;o!==n&&t.playLineEffect(o,n)})},e.prototype.playLineEffect=function(t,e){var o=this;p.default.get(l.default).playEffect(u.SoundPath.eliminate);var n=this.lineEffectFactory.get();n.parent=this.effectLayer,n.getComponent(cc.ParticleSystem).resetSystem(),h.default.getInstance().setParams(n,t,e,500).run(function(){o.lineEffectFactory.put(n)})},e.prototype.checkGameOver=function(){var t=this;this.ringList.some(function(e){return t.checkBlend(e,t.dragRing)})||(d.default.log("\u6e38\u620f\u7ed3\u675f"),this.resultNode.active=!0)},e.prototype.checkBlend=function(t,e){return 0===t.circleList.reduce(function(t,o,n){return t+o*e.circleList[n]},0)},r([v(cc.Node)],e.prototype,"boardNode",void 0),r([v(cc.Prefab)],e.prototype,"ringPre",void 0),r([v(cc.Prefab)],e.prototype,"lineEffectPre",void 0),r([v(cc.Node)],e.prototype,"nextContainer",void 0),r([v(cc.Label)],e.prototype,"scoreLabel",void 0),r([v(cc.Button)],e.prototype,"backBtn",void 0),r([v(cc.Node)],e.prototype,"resultNode",void 0),r([v(cc.Node)],e.prototype,"effectLayer",void 0),r([g],e)}(p.default);o.default=m,cc._RF.pop()},{"./Hall":"Hall","./Ring":"Ring","./SoundMgr":"SoundMgr","./common/Global":"Global","./common/Module":"Module","./common/Move":"Move","./common/NodeFactory":"NodeFactory","./common/Utils":"Utils"}],Global:[function(t,e,o){"use strict";cc._RF.push(e,"a8e6a7+kqFGiLNhPh2PdxFu","Global");var n,i=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0}),o.lineConfig=o.COLOR=o.COLOR_TYPE=o.SoundPath=o.ResPath=o.GConst=o.Global=void 0;var r,c=cc._decorator.ccclass,s=function(){function t(){}var e;return e=t,Object.defineProperty(t,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!1,configurable:!0}),t._ins=null,e=i([c],t)}();o.Global=s,o.GConst={changeSceneTime:.8},o.ResPath={ballRootPath:"texture/ball/"},o.SoundPath={button:"sound/button",blend:"sound/blend",eliminate:"sound/eliminate"},function(t){t[t.NONE=0]="NONE",t[t.RED=1]="RED",t[t.ORANGE=2]="ORANGE",t[t.YELLOW=3]="YELLOW",t[t.BLUE=4]="BLUE",t[t.PURPLE=5]="PURPLE"}(r=o.COLOR_TYPE||(o.COLOR_TYPE={})),o.COLOR=((n={})[r.NONE]=cc.color().fromHEX("#ffffff"),n[r.RED]=cc.color().fromHEX("#ff3737"),n[r.ORANGE]=cc.color().fromHEX("#ff682d"),n[r.YELLOW]=cc.color().fromHEX("#ffc937"),n[r.BLUE]=cc.color().fromHEX("#37a8ff"),n[r.PURPLE]=cc.color().fromHEX("#e476ff"),n),o.lineConfig=[{id:1,type:1,ringsIdx:[1,2,3]},{id:2,type:1,ringsIdx:[4,5,6]},{id:3,type:1,ringsIdx:[7,8,9]},{id:4,type:1,ringsIdx:[1,4,7]},{id:5,type:1,ringsIdx:[2,5,8]},{id:6,type:1,ringsIdx:[3,6,9]},{id:7,type:1,ringsIdx:[1,5,9]},{id:8,type:1,ringsIdx:[3,5,7]},{id:9,type:2,ringsIdx:[1]},{id:10,type:2,ringsIdx:[2]},{id:11,type:2,ringsIdx:[3]},{id:12,type:2,ringsIdx:[4]},{id:13,type:2,ringsIdx:[5]},{id:14,type:2,ringsIdx:[6]},{id:15,type:2,ringsIdx:[7]},{id:16,type:2,ringsIdx:[8]},{id:17,type:2,ringsIdx:[9]}],cc._RF.pop()},{}],Hall:[function(t,e,o){"use strict";cc._RF.push(e,"a9c70bqeNpCj57Qg2CTOfeM","Hall");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("./Game"),s=t("./SoundMgr"),a=t("./common/Global"),l=t("./common/Module"),u=cc._decorator,p=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.startBtn=null,e.showTw=null,e.hideTw=null,e}return i(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.startBtn.node.on("click",this.onClickStart,this);var e=a.GConst.changeSceneTime;this.showTw=cc.tween(this.node).set({opacity:0,active:!0}).to(e,{opacity:255}),this.hideTw=cc.tween(this.node).set({opacity:255}).to(e,{opacity:0}).set({active:!1})},e.prototype.show=function(){this.showTw.start()},e.prototype.hide=function(){this.hideTw.start()},e.prototype.onClickStart=function(){l.default.get(s.default).playEffect(a.SoundPath.button),this.hide(),l.default.get(c.default).show()},r([h(cc.Button)],e.prototype,"startBtn",void 0),r([p],e)}(l.default);o.default=f,cc._RF.pop()},{"./Game":"Game","./SoundMgr":"SoundMgr","./common/Global":"Global","./common/Module":"Module"}],Main:[function(t,e,o){"use strict";cc._RF.push(e,"4606cFBRRNGz4rmBNVvqePT","Main");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("./Hall"),s=t("./common/Module"),a=cc._decorator,l=a.ccclass,u=(a.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.start=function(){s.default.get(c.default).show()},r([l],e)}(s.default));o.default=u,cc._RF.pop()},{"./Hall":"Hall","./common/Module":"Module"}],Module:[function(t,e,o){"use strict";cc._RF.push(e,"4080811dT9FY6D1cynhF7at","Module");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,s=c.ccclass,a=(c.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var o;return i(e,t),o=e,e.get=function(t){var e=cc.js.getClassName(t),n=o.map.get(e);return n||console.error("\u8981\u83b7\u53d6\u7684\u6a21\u5757"+e+"\u5e94\u7ee7\u627fModule\u7c7b, \u4e14\u6267\u884c\u4e86super.onload"),n},e.prototype.onLoad=function(){var t=cc.js.getClassName(this);o.map.get(t)?console.error(t+"\u6b64\u6a21\u5757\u5df2\u6ce8\u518c"):o.map.set(t,this)},e.map=new Map,o=r([s],e)}(cc.Component));o.default=a,cc._RF.pop()},{}],Move:[function(t,e,o){"use strict";cc._RF.push(e,"a97a3pL1e5ISKrX4gtRQXKM","Move"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(){this.pool=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.pool.length},enumerable:!1,configurable:!0}),t.prototype.get=function(){return this.pool.shift()},t.prototype.put=function(t){this.pool.push(t)},t}(),i=function(){function t(){this.target=null,this.startNode=null,this.endNode=null,this.duration=1e3,this.animation=0,this.startTime=0,this.endTime=0,this.startPos=null,this.endPos=null,this.p0=cc.v2(0,0),this.p1=cc.v2(0,0),this.c1=void 0,this.c2=void 0,this.pc1=cc.v2(0,0),this.pc2=cc.v2(0,0),this.isAbsoluteCtrl=!1,this.isFirstFrame=!0,this.setPos=null,this.onComplete=null,this.isMoveComplete=!1,this.timeout=0}return t.getInstance=function(){var e=null;return(e=this.movePool.size>0?this.movePool.get():new t).init(),e},t.putInstance=function(t){t.onNotUse(),this.movePool.put(t)},t.prototype.init=function(){},t.prototype.onNotUse=function(){},t.prototype.onResize=function(){this.updateAllPosition()},t.prototype.setParams=function(t,e,o,n,i,r,c){return this.target=t,this.startNode=e,this.endNode=o,this.duration=n,this.isAbsoluteCtrl=i,this.c1=r,this.c2=c,this},t.prototype.run=function(t){var e=this;return this.timeout=setTimeout(function(){e.isMoveComplete||(e.setPos(1),e.stop())},this.duration+50),this.isMoveComplete=!1,this.target.active=!1,this.isFirstFrame=!0,this.startTime=Date.now(),this.endTime=this.startTime+this.duration,this.updateAllPosition(),this.setPos=this.c1?this.c2?this.setPosByBezier3.bind(this):this.setPosByBezier2.bind(this):this.setPosByLine.bind(this),this.animation=requestAnimationFrame(this.loop.bind(this)),t&&(this.onComplete=t),this},t.prototype.stop=function(e){void 0===e&&(e=!0),this.isMoveComplete=!0,this.target.active=!0,cancelAnimationFrame(this.animation),t.putInstance(this),e&&this.onComplete&&(this.onComplete(),this.onComplete=null)},t.prototype.updateAllPosition=function(){if(this.startNode&&this.endNode&&this.target.parent&&(this.startPos=this.startNode.convertToWorldSpaceAR(cc.v2(0,0)),this.endPos=this.endNode.convertToWorldSpaceAR(cc.v2(0,0)),this.startPos=this.target.parent.convertToNodeSpaceAR(this.startPos),this.endPos=this.target.parent.convertToNodeSpaceAR(this.endPos),this.p1=this.endPos.sub(this.startPos),this.c1)){var t=this.p1.angle(cc.v2(1,0));this.p1.y<0&&(t=-t);var e=this.p1.len();this.unifyPos(this.pc1,this.c1,e),this.pc1.rotateSelf(t),this.c2&&(this.unifyPos(this.pc2,this.c2,e),this.pc2.rotateSelf(t))}},t.prototype.loop=function(){if(!this.isMoveComplete){var t=Date.now();if(t>this.endTime)return this.setPos(1),this.stop(),void clearTimeout(this.timeout);this.isFirstFrame&&(this.isFirstFrame=!1,this.target.active=!0);var e=(t-this.startTime)/this.duration;this.setPos(e),this.animation=requestAnimationFrame(this.loop.bind(this))}},t.prototype.setPosByLine=function(t){var e=t*this.p1.x,o=t*this.p1.y;this.target.x=this.startPos.x+e,this.target.y=this.startPos.y+o},t.prototype.setPosByBezier2=function(t){var e=2*t*(1-t),o=Math.pow(t,2),n=e*this.pc1.x+o*this.p1.x,i=e*this.pc1.y+o*this.p1.y;this.target.x=this.startPos.x+n,this.target.y=this.startPos.y+i},t.prototype.setPosByBezier3=function(t){var e=3*t*Math.pow(1-t,2),o=3*(1-t)*Math.pow(t,2),n=Math.pow(t,3),i=e*this.pc1.x+o*this.pc2.x+n*this.p1.x,r=e*this.pc1.y+o*this.pc2.y+n*this.p1.y;this.target.x=this.startPos.x+i,this.target.y=this.startPos.y+r},t.prototype.unifyPos=function(t,e,o){var n=this.isAbsoluteCtrl?1:o;t.x=e.x*n,t.y=e.y*n},t.movePool=new n,t}();o.default=i,cc._RF.pop()},{}],NodeFactory:[function(t,e,o){"use strict";cc._RF.push(e,"77133qxCMJD9LYjjapnW5EQ","NodeFactory");var n=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0}),o.NodeFactory=void 0;var i=cc._decorator.ccclass,r=function(){function t(){this.pre=null,this.pool=null}return t.prototype.init=function(t){return this.pre=t,this.pool=new cc.NodePool,this},t.prototype.get=function(){var t=null;return(t=this.pool.size()>0?this.pool.get():cc.instantiate(this.pre)).setPosition(0,0),t},t.prototype.put=function(t){this.pool.put(t)},n([i("NodeFactory")],t)}();o.NodeFactory=r,cc._RF.pop()},{}],Result:[function(t,e,o){"use strict";cc._RF.push(e,"e86desCgY5Bzar+g2UDD+LJ","Result");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("./Game"),s=t("./Hall"),a=t("./SoundMgr"),l=t("./common/Global"),u=t("./common/Module"),p=cc._decorator,h=p.ccclass,f=p.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scoreLabel=null,e.againBtn=null,e.backBtn=null,e}return i(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.againBtn.node.on("click",this.onClickAgain,this),this.backBtn.node.on("click",this.onClickBack,this)},e.prototype.onEnable=function(){this.scoreLabel.string=u.default.get(c.default).score.toString()},e.prototype.onClickAgain=function(){u.default.get(a.default).playEffect(l.SoundPath.button),this.node.active=!1,u.default.get(c.default).newGame()},e.prototype.onClickBack=function(){u.default.get(a.default).playEffect(l.SoundPath.button),this.node.active=!1,u.default.get(c.default).hide(),u.default.get(s.default).show()},r([f(cc.Label)],e.prototype,"scoreLabel",void 0),r([f(cc.Button)],e.prototype,"againBtn",void 0),r([f(cc.Button)],e.prototype,"backBtn",void 0),r([h],e)}(u.default);o.default=d,cc._RF.pop()},{"./Game":"Game","./Hall":"Hall","./SoundMgr":"SoundMgr","./common/Global":"Global","./common/Module":"Module"}],Ring:[function(t,e,o){"use strict";cc._RF.push(e,"09a30XuRXdM64Rr0Zjubjms","Ring");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("./Game"),s=t("./SoundMgr"),a=t("./common/Global"),l=t("./common/Module"),u=t("./common/Utils"),p=cc._decorator,h=p.ccclass,f=p.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.circleContainer=null,e.touchLayer=null,e.canDrag=!1,e.canBlend=!1,e.Game=null,e.circleList=[a.COLOR_TYPE.NONE,a.COLOR_TYPE.NONE,a.COLOR_TYPE.NONE],e}var o;return i(e,t),o=e,e.prototype.onLoad=function(){this.Game=l.default.get(c.default),this.addEvents()},e.prototype.addEvents=function(){this.touchLayer.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.touchLayer.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this)},e.prototype.reset=function(){this.circleList[0]=this.circleList[1]=this.circleList[2]=a.COLOR_TYPE.NONE,this.updateUI()},e.prototype.initAsBlend=function(){this.canBlend=!0,this.canDrag=!1,this.reset()},e.prototype.initAsDrag=function(){this.canBlend=!1,this.canDrag=!0,this.createCircles(),this.updateUI()},e.prototype.onTouchMove=function(t){if(this.canDrag){o.selected||(o.selected=this);var e=o.selected.node.parent.convertToNodeSpaceAR(t.getLocation());o.selected.node.setPosition(e)}},e.prototype.onTouchEnd=function(){if(this.canDrag&&o.selected){var t=this.getBlendTarget();t&&t.blendSelf(o.selected)?(l.default.get(s.default).playEffect(a.SoundPath.blend),this.Game.ringFactory.put(o.selected.node),o.selected=null,this.Game.checkEliminate(),this.Game.createDragRing(),this.Game.checkGameOver()):o.selected.node.setPosition(0,0)}},e.prototype.getBlendTarget=function(){if(o.selected){for(var t=cc.v2(),e=o.selected.node.convertToWorldSpaceAR(t),n=0,i=this.Game.ringList;n<i.length;n++){var r=i[n];if(r.canBlend){var c=r.node.convertToWorldSpaceAR(t);if(u.default.getDistance(e,c)<=r.getTouchSize())return r}}return null}},e.prototype.getTouchSize=function(){return this.touchLayer.width/2},e.prototype.blendSelf=function(t){var e=this;return!!this.Game.checkBlend(this,t)&&(this.circleList.forEach(function(o,n){e.circleList[n]=o+t.circleList[n]}),this.updateUI(),!0)},e.prototype.updateUI=function(){var t=this;this.circleContainer.children.forEach(function(e,o){var n=t.circleList[o];n===a.COLOR_TYPE.NONE?e.opacity=1:(e.color=a.COLOR[n],e.opacity=255)})},e.prototype.createCircles=function(){for(var t=Math.random()>.7?2:1,e=u.default.randomFromArray([0,1,2],t),o=0;o<3;o++)e.includes(o)?this.circleList[o]=u.default.randomFromArray(this.Game.ringColors)[0]:this.circleList[o]=a.COLOR_TYPE.NONE},e.prototype.isSameColor=function(){var t=this.circleList[0];return t!==a.COLOR_TYPE.NONE&&this.circleList.every(function(e){return e===t})},e.prototype.eliminateCircle=function(t){var e=this;this.circleList.forEach(function(o,n){t.includes(o)&&(e.circleList[n]=a.COLOR_TYPE.NONE,e.Game.score+=1)}),this.updateUI()},e.prototype.getCircleColor=function(t){return this.circleList[t]},e.prototype.isIncludeColor=function(t){return this.circleList.includes(t)},e.selected=null,r([f(cc.Node)],e.prototype,"circleContainer",void 0),r([f(cc.Node)],e.prototype,"touchLayer",void 0),o=r([h],e)}(cc.Component);o.default=d,cc._RF.pop()},{"./Game":"Game","./SoundMgr":"SoundMgr","./common/Global":"Global","./common/Module":"Module","./common/Utils":"Utils"}],SoundMgr:[function(t,e,o){"use strict";cc._RF.push(e,"97e45uMsJRKUISAAXcXOki6","SoundMgr");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("./common/Global"),s=t("./common/Module"),a=cc._decorator,l=a.ccclass,u=a.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.audioSource=null,e.soundBtn=null,e.muteNode=null,e.notMuteNode=null,e.clips=new Map,e}return i(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.soundBtn.node.on("click",this.switchSound,this),this.audioSource.mute=!1,this.muteNode&&(this.muteNode.active=!1),this.notMuteNode&&(this.notMuteNode.active=!0)},e.prototype.switchSound=function(){this.playEffect(c.SoundPath.button);var t=this.audioSource.mute=!this.audioSource.mute;this.muteNode&&(this.muteNode.active=t),this.notMuteNode&&(this.notMuteNode.active=!t)},e.prototype.playEffect=function(t){var e=this,o=this.clips.get(t);o?cc.audioEngine.play(o,!1,.5):cc.resources.load(t,cc.AudioClip,function(o,n){o||(e.clips.set(t,n),cc.audioEngine.play(n,!1,.5))})},r([u(cc.AudioSource)],e.prototype,"audioSource",void 0),r([u(cc.Button)],e.prototype,"soundBtn",void 0),r([u(cc.Node)],e.prototype,"muteNode",void 0),r([u(cc.Node)],e.prototype,"notMuteNode",void 0),r([l],e)}(s.default);o.default=p,cc._RF.pop()},{"./common/Global":"Global","./common/Module":"Module"}],Utils:[function(t,e,o){"use strict";cc._RF.push(e,"08a78iCxUhGp52dpLR82atV","Utils");var n=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c},i=this&&this.__spreadArrays||function(){for(var t=0,e=0,o=arguments.length;e<o;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<o;e++)for(var r=arguments[e],c=0,s=r.length;c<s;c++,i++)n[i]=r[c];return n};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=(r.property,function(){function t(){}var e;return e=t,t.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},t.randomInt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var o=Math.floor(Math.min.apply(Math,t)),n=Math.floor(Math.max.apply(Math,t));return Math.floor(Math.random()*(++n-o))+o},t.randomFromArray=function(t,o){void 0===o&&(o=1);var n=[],r=i(t);o=Math.min(o,r.length);for(var c=0;c<o;c++){var s=e.randomInt(0,r.length-1),a=r.splice(s,1)[0];n.push(a)}return n},t.dynamicSprite=function(t,o,n){t instanceof cc.Node&&(t=t.getComponent(cc.Sprite)||t.addComponent(cc.Sprite)),cc.resources.load(o,cc.SpriteFrame,function(i,r){i?e.log("\u52a0\u8f7d\u56fe\u7247\u9519\u8bef",o,i):(t.spriteFrame=r,n&&n(r))})},t.flat=function(t){return t.reduce(function(t,e){var o;return(o=t).push.apply(o,e),t},[])},t.getDistance=function(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},e=n([c],t)}());o.default=s,window.Utils=s,cc._RF.pop()},{}]},{},["Game","Hall","Main","Result","Ring","SoundMgr","Global","Module","Move","NodeFactory","Utils"]);