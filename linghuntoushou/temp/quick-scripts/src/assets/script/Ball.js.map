{"version":3,"sources":["assets\\script\\Ball.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import Game from \"./Game\";\r\nimport { Global, Vec2Group } from \"./common/Global\";\r\nimport Module from \"./common/Module\";\r\nimport Utils from \"./common/Utils\";\r\n\r\n\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n/**单个格子 */\r\n@ccclass\r\nexport default class Ball extends cc.Component {\r\n\r\n    private Game: Game = null;\r\n    private rigid: cc.RigidBody = null;\r\n    private posGroup: Vec2Group = null;\r\n    private speed: cc.Vec2 = cc.v2();\r\n    private isEffectHit: boolean = false;    //篮框碰撞开始是否有效\r\n    /**跳跃时球的速度标量 */\r\n    public jumpSpeedX: number = 500;\r\n    public jumpSpeedY: number = 1800;\r\n    public isOnGround: boolean = false;        //球在地上\r\n\r\n    protected onLoad(): void {\r\n        this.Game = Module.get(Game);\r\n        this.rigid = this.node.getComponent(cc.RigidBody);\r\n        this.posGroup = new Vec2Group();\r\n    }\r\n\r\n    /**重置到初始状态，暂停物理组件 */\r\n    public reset() {\r\n        this.rigid.type = cc.RigidBodyType.Static;\r\n        this.setSpeed(0, 0);\r\n        this.node.setPosition(0, 0);\r\n        this.isEffectHit = false;\r\n    }\r\n\r\n    /**触发跳跃 */\r\n    public jump() {\r\n        if (this.rigid.type === cc.RigidBodyType.Static)\r\n            this.rigid.type = cc.RigidBodyType.Dynamic;\r\n        this.setSpeed(this.jumpSpeedX * this.Game.basketDirection, this.jumpSpeedY);\r\n    }\r\n\r\n    protected update(dt: number): void {\r\n        let pos = this.node.position;\r\n        if (pos.x < -640) {\r\n            this.node.x += 1280;\r\n        } else if (pos.x > 640) {\r\n            this.node.x -= 1280;\r\n        }\r\n    }\r\n\r\n    /**设置速度 */\r\n    private setSpeed(x: number, y: number) {\r\n        this.speed.x = x;\r\n        this.speed.y = y;\r\n        this.rigid.linearVelocity = this.speed;\r\n    }\r\n\r\n    /**获取速度 */\r\n    private getSpeed(): cc.Vec2 {\r\n        return this.rigid.linearVelocity;\r\n    }\r\n\r\n    onCollisionEnter(other, self) {\r\n        if (other.node.group === 'basket') {\r\n            let isDown = this.getSpeed().y < 0;\r\n            this.isEffectHit = isDown;\r\n        }\r\n        if (other.node.group === `ground`) {\r\n            this.isOnGround = true;\r\n            if (this.Game.isTimeEnd) this.Game.gameOver();\r\n        }\r\n    }\r\n\r\n    onCollisionExit(other, self) {\r\n        if (other.node.group === 'basket' && this.isEffectHit) {\r\n            this.isEffectHit = false;\r\n            let isDown = this.getSpeed().y < 0;\r\n            if (isDown) {\r\n                this.Game.onHit();\r\n            }\r\n        }\r\n        if (other.node.group === `ground`) {\r\n            this.isOnGround = false;\r\n        }\r\n    }\r\n\r\n\r\n}\r\n"]}