{"version":3,"sources":["assets\\script\\Game.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import Ball from \"./Ball\";\r\nimport Basket from \"./Basket\";\r\nimport Clock, { CLOCK_UIMODE, IClockParam, IClockView } from \"./Clock\";\r\nimport Launch from \"./Launch\";\r\nimport Settle from \"./Settle\";\r\nimport Module from \"./common/Module\";\r\nimport { NodeFactory } from \"./common/NodeFactory\";\r\nimport Utils from \"./common/Utils\";\r\n\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class Game extends Module {\r\n    @property(cc.Node)\r\n    ballNode: cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    basketNode: cc.Node = null;\r\n\r\n    @property(cc.ProgressBar)\r\n    progress: cc.ProgressBar = null;\r\n\r\n    @property(cc.Label)\r\n    timeLabel: cc.Label = null;\r\n\r\n    @property(cc.Label)\r\n    scoreLabel: cc.Label = null;\r\n\r\n\r\n\r\n\r\n    private ball: Ball = null;\r\n    private basket: Basket = null;\r\n    /**当前篮筐方向 左负右正 */\r\n    public basketDirection: number = 1;\r\n    /**是否结束 */\r\n    public isTimeEnd: boolean = false;\r\n    private clock: Clock = null;\r\n    private isGameOver: boolean = false;\r\n\r\n\r\n    private _score: number = 0;\r\n    private get score(): number {\r\n        return this._score;\r\n    }\r\n    private set score(v: number) {\r\n        this._score = v;\r\n        this.scoreLabel.string = v.toString();\r\n    }\r\n\r\n    protected onLoad(): void {\r\n        this.ball = this.ballNode.getComponent(Ball);\r\n        this.basket = this.basketNode.getComponent(Basket);\r\n        this.addEvents();\r\n        this.initClock();\r\n        Module.get(Settle).hide();\r\n    }\r\n\r\n\r\n    public show() {\r\n        this.node.active = true;\r\n        this.node.runAction(cc.fadeIn(1));\r\n        this.newGame();\r\n    }\r\n\r\n    public hide() {\r\n        this.node.runAction(cc.fadeOut(1));\r\n        setTimeout(() => {\r\n            this.node.active = false;\r\n        }, 1000);\r\n    }\r\n\r\n    private addEvents() {\r\n        this.node.on(cc.Node.EventType.TOUCH_END, this.onTouchEnd, this);\r\n    }\r\n\r\n    private initClock() {\r\n        let param: IClockParam = {\r\n            totalTime: 5,\r\n            endCall: this.onTimeEnd.bind(this)\r\n        };\r\n\r\n        let uiParam: IClockView = {\r\n            viewMode: CLOCK_UIMODE.showRemain,\r\n            progress: this.progress,\r\n            timeLabel: this.timeLabel,\r\n        }\r\n        let clock = this.clock = new Clock();\r\n        clock.init(param).initView(uiParam);\r\n    }\r\n\r\n    public newGame() {\r\n        this.clock.reset();\r\n        this.basketDirection = -1;\r\n        this.basket.reset(this.basketDirection);\r\n        this.ball.reset();\r\n        this.isTimeEnd = false;\r\n        this.score = 0;\r\n        this.isGameOver = false;\r\n    }\r\n\r\n    private onTouchEnd(e: cc.Event.EventTouch) {\r\n        if (this.isTimeEnd) return;\r\n        this.ball.jump();\r\n    }\r\n\r\n    /**达成目标 */\r\n    public onHit() {\r\n        this.score++;\r\n        this.basketDirection *= -1;\r\n        this.basket.reset(this.basketDirection);\r\n        this.clock.reset().start();\r\n        this.isTimeEnd = false;\r\n    }\r\n\r\n    private onTimeEnd() {\r\n        this.isTimeEnd = true;\r\n        if (this.ball.isOnGround) {\r\n            this.gameOver();\r\n        }\r\n    }\r\n\r\n    public gameOver() {\r\n        if (!this.isGameOver) {\r\n            this.isGameOver = true;\r\n            Module.get(Settle).show(this.score);\r\n        }\r\n    }\r\n\r\n}\r\n"]}