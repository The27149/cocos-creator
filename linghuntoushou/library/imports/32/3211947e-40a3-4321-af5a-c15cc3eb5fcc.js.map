{"version":3,"sources":["assets\\script\\common\\Move.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["class Pool {\r\n    private pool: any[] = [];\r\n\r\n    public get size() {\r\n        return this.pool.length;\r\n    }\r\n\r\n    public get(): any {\r\n        return this.pool.shift();\r\n    }\r\n\r\n    public put(item: any) {\r\n        this.pool.push(item);\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * 自定义位移动画\r\n */\r\nexport default class Move {\r\n    private static movePool: Pool = new Pool();\r\n\r\n\r\n\r\n    /**\r\n     * 获取一个运动实例\r\n     */\r\n    public static getInstance(): Move {\r\n        let move: Move = null;\r\n        move = this.movePool.size > 0 ? this.movePool.get() : new Move();\r\n        move.init();\r\n        return move;\r\n    }\r\n\r\n    /**\r\n     * 回收一个运动实例\r\n     */\r\n    private static putInstance(item: Move) {\r\n        item.onNotUse();\r\n        this.movePool.put(item);\r\n    }\r\n\r\n\r\n    private target: cc.Node = null;\r\n    //private container: cc.Node = null;\r\n    private startNode: cc.Node = null;\r\n    private endNode: cc.Node = null;\r\n    //运动时间 ms\r\n    private duration: number = 1000;\r\n\r\n    //最新调用的动画\r\n    private animation: number = 0;\r\n    private startTime: number = 0;\r\n    private endTime: number = 0;\r\n\r\n    private startPos: cc.Vec2 = null;\r\n    private endPos: cc.Vec2 = null;\r\n\r\n\r\n    private p0: cc.Vec2 = cc.v2(0, 0);      //起点\r\n    private p1: cc.Vec2 = cc.v2(0, 0);      //相对终点\r\n    private c1: cc.Vec2 = undefined;             //控制点1参数 \r\n    private c2: cc.Vec2 = undefined;             //控制点2参数 \r\n    private pc1: cc.Vec2 = cc.v2(0, 0);          //控制点1 实际坐标\r\n    private pc2: cc.Vec2 = cc.v2(0, 0);          //控制点2 实际坐标\r\n    private isAbsoluteCtrl: boolean = false;     //控制点是否使用绝对坐标\r\n\r\n    private isFirstFrame: boolean = true;\r\n\r\n    private setPos: Function = null;\r\n    public onComplete: Function = null;\r\n\r\n    private isMoveComplete: boolean = false;\r\n    private timeout: number = 0;            //检验动作是否完成定时器\r\n\r\n    private init() {\r\n        // game.EventManager.getInstance().addEventListener(game.Const.mess_windowResize, this.onResize, this);\r\n    }\r\n\r\n    private onNotUse() {\r\n        // game.EventManager.getInstance().removeEventListener(game.Const.mess_windowResize, this.onResize, this);\r\n    }\r\n\r\n    private onResize() {\r\n        this.updateAllPosition();\r\n    }\r\n\r\n    /**\r\n     * 设置运动参数\r\n     * @param target        运动主体\r\n     * @param startNode     起点\r\n     * @param endNode       终点\r\n     * @param duration      运动时间 ms \r\n     * @param isAbsoluteCtrl 控制点类型：绝对坐标/相对距离的比例 （默认选用比例来表示控制点）\r\n     * @param c1            贝塞尔曲线控制点1   分量小于1时表示 起点到终点的比例\r\n     * @param c2            贝塞尔曲线控制点2   分量小于1时表示 起点到终点的比例\r\n     * @returns \r\n     */\r\n    public setParams(target: cc.Node, startNode: cc.Node, endNode: cc.Node, duration: number, isAbsoluteCtrl?: boolean, c1?: cc.Vec2, c2?: cc.Vec2): Move {\r\n        this.target = target;\r\n        this.startNode = startNode;\r\n        this.endNode = endNode;\r\n        this.duration = duration;\r\n        this.isAbsoluteCtrl = isAbsoluteCtrl;\r\n        this.c1 = c1;\r\n        this.c2 = c2;\r\n        return this;\r\n    }\r\n\r\n    public run(call?: Function): Move {\r\n        //切后台情况下 用定时器同步目标位置 加50ms为了保证正常情况下优先走正常流程\r\n        this.timeout = setTimeout(() => {\r\n            if (!this.isMoveComplete) {\r\n                this.setPos(1);\r\n                this.stop();\r\n            }\r\n        }, this.duration + 50);\r\n        this.isMoveComplete = false;\r\n        //未被计算位置时第一帧隐藏\r\n        this.target.active = false;\r\n        this.isFirstFrame = true;\r\n        this.startTime = Date.now();\r\n        this.endTime = this.startTime + this.duration;\r\n        this.updateAllPosition();\r\n        this.setPos = this.c1 ? this.c2 ? this.setPosByBezier3.bind(this) : this.setPosByBezier2.bind(this) : this.setPosByLine.bind(this);\r\n        this.animation = requestAnimationFrame(this.loop.bind(this));\r\n        if (call) this.onComplete = call;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * 停止这个动作\r\n     * @param DoComplete \r\n     */\r\n    public stop(DoComplete: boolean = true): void {\r\n        this.isMoveComplete = true;\r\n        this.target.active = true;\r\n        cancelAnimationFrame(this.animation);\r\n        Move.putInstance(this);\r\n        if (DoComplete && this.onComplete) {\r\n            this.onComplete();\r\n            this.onComplete = null;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 更新起始点位置\r\n     */\r\n    public updateAllPosition(): void {\r\n        if (!(this.startNode && this.endNode && this.target.parent)) return;\r\n        this.startPos = this.startNode.convertToWorldSpaceAR(cc.v2(0, 0));\r\n        this.endPos = this.endNode.convertToWorldSpaceAR(cc.v2(0, 0));\r\n        this.startPos = this.target.parent.convertToNodeSpaceAR(this.startPos);\r\n        this.endPos = this.target.parent.convertToNodeSpaceAR(this.endPos);\r\n        this.p1 = this.endPos.sub(this.startPos);\r\n        if (this.c1) {\r\n            let rad = this.p1.angle(cc.v2(1, 0));       //0-pi\r\n            if (this.p1.y < 0) rad = -rad;\r\n            let len = this.p1.len();\r\n            this.unifyPos(this.pc1, this.c1, len);\r\n            this.pc1.rotateSelf(rad);\r\n            if (this.c2) {\r\n                this.unifyPos(this.pc2, this.c2, len);\r\n                this.pc2.rotateSelf(rad);\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n\r\n    private loop(time: number): void {\r\n        if (this.isMoveComplete) return;\r\n        let now = Date.now();\r\n        if (now > this.endTime) {\r\n            this.setPos(1);\r\n            this.stop();\r\n            clearTimeout(this.timeout);\r\n            return;\r\n        }\r\n        if (this.isFirstFrame) {\r\n            this.isFirstFrame = false;\r\n            this.target.active = true;\r\n        }\r\n        let t = (now - this.startTime) / this.duration;\r\n        this.setPos(t);\r\n        this.animation = requestAnimationFrame(this.loop.bind(this));\r\n    }\r\n\r\n\r\n    //一次曲线（直线）计算位置\r\n    private setPosByLine(t: number): void {\r\n        let tempX = t * this.p1.x,\r\n            tempY = t * this.p1.y;\r\n        this.target.x = this.startPos.x + tempX;\r\n        this.target.y = this.startPos.y + tempY;\r\n    }\r\n\r\n    //二次曲线计算位置\r\n    private setPosByBezier2(t: number): void {\r\n        let b = 2 * t * (1 - t),\r\n            c = t ** 2;\r\n        let tempX = b * this.pc1.x + c * this.p1.x,\r\n            tempY = b * this.pc1.y + c * this.p1.y;\r\n        this.target.x = this.startPos.x + tempX;\r\n        this.target.y = this.startPos.y + tempY;\r\n    }\r\n\r\n    //三次曲线计算位置\r\n    private setPosByBezier3(t: number): void {\r\n        let b = 3 * t * (1 - t) ** 2,\r\n            c = 3 * (1 - t) * t ** 2,\r\n            d = t ** 3;\r\n        let tempX = b * this.pc1.x + c * this.pc2.x + d * this.p1.x,\r\n            tempY = b * this.pc1.y + c * this.pc2.y + d * this.p1.y;\r\n        this.target.x = this.startPos.x + tempX;\r\n        this.target.y = this.startPos.y + tempY;\r\n    }\r\n\r\n    /**\r\n     * 统一坐标 \r\n     * @param target 要改造的向量\r\n     * @param v 比例参数\r\n     * @param len 比例参考长度\r\n     */\r\n    private unifyPos(target: cc.Vec2, v: cc.Vec2, len: number) {\r\n        let ratio = this.isAbsoluteCtrl ? 1 : len;\r\n        target.x = v.x * ratio;\r\n        target.y = v.y * ratio;\r\n    }\r\n\r\n}\r\n"]}