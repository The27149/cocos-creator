{"version":3,"sources":["assets\\customComponents\\shop\\script\\ShopItem.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import CoinMgr from \"../../../script/CoinMgr\";\r\nimport { GConst, Global } from \"../../../script/common/Global\";\r\nimport Utils from \"../../../script/common/Utils\";\r\nimport Shop from \"./Shop\";\r\nimport ShopData, { IPropItem } from \"./ShopData\";\r\n\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class ShopItem extends cc.Component {\r\n\r\n    @property(cc.Sprite)\r\n    propSp: cc.Sprite = null;\r\n\r\n    @property(cc.Label)\r\n    costLabel: cc.Label = null;\r\n\r\n    @property(cc.Node)\r\n    lockNode: cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    pickNode: cc.Node = null;\r\n\r\n    private isLock: boolean = false;\r\n    private isPick: boolean = false;\r\n    private data: IPropItem = null;\r\n    private shop: Shop = null;\r\n\r\n    protected onLoad(): void {\r\n        this.node.on(cc.Node.EventType.TOUCH_END, this.onTouchEnd, this);\r\n    }\r\n\r\n    private onTouchEnd(e: cc.Event.EventTouch) {\r\n        if (this.isLock) {\r\n            this.buy();\r\n        } else {\r\n            this.pick();\r\n        }\r\n    }\r\n\r\n    public init(data: IPropItem, shop: Shop) {\r\n        this.data = data;\r\n        this.shop = shop;\r\n        let path = `shop/texture/ball/lanqiu${data.type}`;\r\n        Utils.dynamicSpriteInBundle(this.propSp, GConst.customCompBundle, path);\r\n        this.costLabel.string = data.cost.toString();\r\n        this.setLock(data.isLock);\r\n        this.setPick(data.isPick);\r\n    }\r\n\r\n    private setLock(state: boolean) {\r\n        this.isLock = state;\r\n        this.lockNode.active = state;\r\n        ShopData.ins.setLock(this.data.type, state);\r\n    }\r\n\r\n    public setPick(state: boolean) {\r\n        this.isPick = state;\r\n        this.pickNode.active = state;\r\n        ShopData.ins.setPick(this.data.type, state);\r\n        Global.ins.shopPickType = this.data.type;\r\n    }\r\n\r\n    private buy() {\r\n        let coin = CoinMgr.ins.getCoin();\r\n        if (coin < this.data.cost) {\r\n            Utils.log(`星星不够，买不了`);\r\n            return;\r\n        } else {\r\n            CoinMgr.ins.changeCoin(-this.data.cost);\r\n            this.setLock(false);\r\n        }\r\n    }\r\n\r\n    private pick() {\r\n        if (this.isLock) return;\r\n        this.shop.unPickAll();\r\n        this.setPick(true);\r\n    }\r\n\r\n}\r\n"]}